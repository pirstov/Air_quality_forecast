#!/bin/bash

# Set the directory containing the forecast files
TARGET_DIR="/scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND6-forecast"

# Get the dates for today, yesterday, and two days ago in YYYYMMDD format
TODAY=$(date +"%Y%m%d")
YESTERDAY=$(date -d "yesterday" +"%Y%m%d")
DAY_BEFORE_YESTERDAY=$(date -d "2 days ago" +"%Y%m%d")

# Remove files older than three days
find "$TARGET_DIR" -type f \(   -name "wrfout_d01_*" -o   -name "end.*_nest-FINLAND6-forecast.nc" -o   -name "chim_nest-FINLAND6-forecast_*_start.nc" -o   -name "chim_nest-FINLAND6-forecast_*_out.nc" -o   -name "chim_nest-FINLAND6-forecast_*_sem.nc" -o   -name "chim_nest-FINLAND6-forecast_*_dem.nc" -o   -name "chim_nest-FINLAND6-forecast_*_bem.nc" -o   -name "chim_nest-FINLAND6-forecast_*_aem.nc"   \) ! -name "*${TODAY}*" ! -name "*${YESTERDAY}*" ! -name "*${DAY_BEFORE_YESTERDAY}*" -exec rm -f {} \;

echo "Cleanup complete: Removed files older than $DAY_BEFORE_YESTERDAY"


#!/bin/bash

# Set the directory containing the forecast files
TARGET_DIR="/scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND6-forecast"

# Get the dates for today, yesterday, and two days ago in YYYYMMDD format
TODAY=$(date +"%Y%m%d")
YESTERDAY=$(date -d "yesterday" +"%Y%m%d")
DAY_BEFORE_YESTERDAY=$(date -d "2 days ago" +"%Y%m%d")

# Find and list files that would be deleted (without deleting them)
echo "Files that would be deleted:"
find "$TARGET_DIR" -type f \(   -name "wrfout_d01_*" -o   -name "end.*_nest-FINLAND6-forecast.nc" -o   -name "chim_nest-FINLAND6-forecast_*_start.nc" -o   -name "chim_nest-FINLAND6-forecast_*_out.nc" -o   -name "chim_nest-FINLAND6-forecast_*_sem.nc" -o   -name "chim_nest-FINLAND6-forecast_*_dem.nc" -o   -name "chim_nest-FINLAND6-forecast_*_bem.nc" -o   -name "chim_nest-FINLAND6-forecast_*_aem.nc" \
\) ! -name "*${TODAY}*" ! -name "*${YESTERDAY}*" ! -name "*${DAY_BEFORE_YESTERDAY}*" -print

echo "Test run complete. No files were deleted."




find /scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND6-forecast -type f -name "chim_nest-FINLAND6-forecast_*_72_out.nc" ! -name "*$(date +"%Y%m%d")*" ! -name "*$(date -d "yesterday" +"%Y%m%d")*" ! -name "*$(date -d "2 days ago" +"%Y%m%d")*"  -print








#############################
#!/bin/bash

# Set the directory containing the forecast files
TARGET_DIR="/scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND6-forecast"

# Get the dates for today, yesterday, and two days ago in YYYYMMDD format
TODAY=$(date +"%Y%m%d")
YESTERDAY=$(date -d "yesterday" +"%Y%m%d")
DAY_BEFORE_YESTERDAY=$(date -d "2 days ago" +"%Y%m%d")

# Find and list files that would be deleted (without deleting them)
echo "Files that would be deleted:"

# List files for chim_nest-FINLAND6-forecast_*_72_out.nc
find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND6-forecast_*_72_out.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;

# List files for chim_nest-FINLAND6-forecast_*_72_dem.nc
find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND6-forecast_*_72_dem.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;

# List files for chim_nest-FINLAND6-forecast_*_72_bem.nc
find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND6-forecast_*_72_bem.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;

# List files for chim_nest-FINLAND6-forecast_*_72_aem.nc
find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND6-forecast_*_72_aem.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;
# List files for wrfout_d01_* (no _72_ added)
find "$TARGET_DIR" -type f   -name "wrfout_d01_*_00:00:00"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;

echo "Test run complete. No files were deleted."
#############################
find "/scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND6-forecast"  -type f   -name "wrfout_d01_*_00:00:00"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -print



end.*_72_nest-FINLAND6-forecast.nc
chim_nest-FINLAND6-forecast_*_72_start.nc
chim_nest-FINLAND6-forecast_*_72_sem.nc

############ Final correct code: 0 0 * * * /usr/bin/sbatch /projappl/project_2012160/CHIMERE/forecast_automation.sh


#############
#!/bin/bash

# Set the directory containing the forecast files
TARGET_DIR="/scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND6-forecast"

# Get the dates for today, yesterday, and two days ago in YYYYMMDD format
TODAY=$(date +"%Y%m%d")
YESTERDAY=$(date -d "yesterday" +"%Y%m%d")
DAY_BEFORE_YESTERDAY=$(date -d "2 days ago" +"%Y%m%d")

# Function to delete old files based on pattern
delete_old_files() {
    local pattern="$1"
    find "$TARGET_DIR" -type f -name "$pattern" \
        ! -name "*${TODAY}*" \
        ! -name "*${YESTERDAY}*" \
        ! -name "*${DAY_BEFORE_YESTERDAY}*" \
        -exec rm -f {} \;
}

# List of file patterns to delete
delete_old_files "chim_nest-FINLAND6-forecast_*_72_out.nc"
delete_old_files "chim_nest-FINLAND6-forecast_*_72_dem.nc"
delete_old_files "chim_nest-FINLAND6-forecast_*_72_bem.nc"
delete_old_files "chim_nest-FINLAND6-forecast_*_72_aem.nc"
delete_old_files "wrfout_d01_*_00:00:00"
delete_old_files "end.*_72_nest-FINLAND6-forecast.nc"
delete_old_files "chim_nest-FINLAND6-forecast_*_72_start.nc"
delete_old_files "chim_nest-FINLAND6-forecast_*_72_sem.nc"

echo "File deletion complete."
########################################################
TEST FIND files:


----------------------------------------------------------------
#!/bin/bash

# Set the directory containing the forecast files
TARGET_DIR="/scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND6-forecast"

# Get the dates for today, yesterday, and two days ago in YYYYMMDD format
TODAY=$(date +"%Y%m%d")
YESTERDAY=$(date -d "yesterday" +"%Y%m%d")
DAY_BEFORE_YESTERDAY=$(date -d "2 days ago" +"%Y%m%d")

# Function to list files that would be deleted based on pattern
list_old_files() {
    local pattern="$1"
    find "$TARGET_DIR" -type f -name "$pattern" \
        ! -name "*${TODAY}*" \
        ! -name "*${YESTERDAY}*" \
        ! -name "*${DAY_BEFORE_YESTERDAY}*"
}

# List files to be deleted
echo "Files that would be deleted:"
list_old_files "chim_nest-FINLAND6-forecast_*_72_out.nc"
list_old_files "chim_nest-FINLAND6-forecast_*_72_dem.nc"
list_old_files "chim_nest-FINLAND6-forecast_*_72_bem.nc"
list_old_files "chim_nest-FINLAND6-forecast_*_72_aem.nc"
list_old_files "wrfout_d01_*_00:00:00"
list_old_files "end.*_72_nest-FINLAND6-forecast.nc"
list_old_files "chim_nest-FINLAND6-forecast_*_72_start.nc"
list_old_files "chim_nest-FINLAND6-forecast_*_72_sem.nc"

echo "Test run complete. No files were deleted."
---------------------------------------------------------------------------------NOW finland 18

 cat cleanup_chim_fin_forecast6.sh
#!/bin/bash



# Set the directory containing the forecast files

TARGET_DIR="/scratch/project_2012160/CHIMERE/chimere_forecast/nest-FINLAND18-forecast"



# Get the dates for today, yesterday, and two days ago in YYYYMMDD format

TODAY=$(date +"%Y%m%d")

YESTERDAY=$(date -d "yesterday" +"%Y%m%d")

DAY_BEFORE_YESTERDAY=$(date -d "2 days ago" +"%Y%m%d")



# Find and list files that would be deleted (without deleting them)

echo "Files that would be deleted:"



# List files for chim_nest-FINLAND18-forecast_*_72_out.nc

find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND18-forecast_*_72_out.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;



# List files for chim_nest-FINLAND18-forecast_*_72_dem.nc

find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND18-forecast_*_72_dem.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;



# List files for chim_nest-FINLAND18-forecast_*_72_bem.nc

find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND18-forecast_*_72_bem.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;



# List files for chim_nest-FINLAND18-forecast_*_72_aem.nc

find "$TARGET_DIR" -type f   -name "chim_nest-FINLAND18-forecast_*_72_aem.nc"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;

# List files for wrfout_d01_* (no _72_ added)

find "$TARGET_DIR" -type f   -name "wrfout_d01_*_00:00:00"   ! -name "*${TODAY}*"   ! -name "*${YESTERDAY}*"   ! -name "*${DAY_BEFORE_YESTERDAY}*"   -exec rm -f {} \;



echo "Test run complete. No files were deleted."


############# chmod +x test_cleanup.sh
  722  ./test_cleanup.sh 

  463  sacct
  464  sacct -u senanaya
  465  cd /users/senanaya/
  466  ls
  467  ls -ltrh
  468  cat slurm-4243627.out
  469  cd /projappl/project_2012160/CHIMERE/ 
  470  ls
  471  crontab -l
  472  cat automation_test.sh
  473  cat /users/senanaya/slurm-4243627.out
  474  tail -f slurm-4243627.out
  475  cat /users/senanaya/slurm-4243627.out
  476  tail -f  /users/senanaya/slurm-4243627.out


automation crontab -e command : 50 09 * * * /usr/bin/sbatch /projappl/project_2012160/CHIMERE/forecast_automation.sh



